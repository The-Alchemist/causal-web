function plotGraph(j){var b = {}; j.forEach(function(m){m.source = b[m.source] || (b[m.source] = {name:m.source}); m.target = b[m.target] || (b[m.target] = {name:m.target})}); var d = window.innerWidth; var k = window.innerHeight; var g = d3.select("body").append("svg").attr("width", "100%").attr("height", k); var c = d3.layout.force().nodes(d3.values(b)).links(j).size([d, k]).linkDistance(60).charge( - 300).on("tick", f).start(); g.append("svg:defs").append("svg:marker").attr("id", "end-arrow").attr("viewBox", "0 -5 10 10").attr("refX", 15).attr("refY", - 1.5).attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto").append("svg:path").attr("d", "M0,-5L10,0L0,5"); g.append("svg:defs").append("svg:marker").attr("id", "start-arrow").attr("viewBox", "0 -5 10 10").attr("refX", - 5).attr("refY", - 1.5).attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto").append("svg:path").attr("d", "M10,-5L0,0L10,5"); g.append("svg:defs").append("svg:marker").attr("id", "circle-start-arrow").attr("viewBox", "0 -5 10 10").attr("refX", - 5).attr("refY", - 1.5).attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto").append("svg:circle").attr("cx", 6).attr("cy", 0).attr("r", 4); g.append("svg:defs").append("svg:marker").attr("id", "circle-end-arrow").attr("viewBox", "0 -5 10 10").attr("refX", 15).attr("refY", - 1.5).attr("markerWidth", 6).attr("markerHeight", 6).attr("orient", "auto").append("svg:circle").attr("cx", 4).attr("cy", 0).attr("r", 4); var l = g.append("svg:g").selectAll("path").data(c.links()).enter().append("svg:path").attr("class", "link").attr("marker-start", function(m){if (m.type === "<->"){return"url(#start-arrow)"} else{if (m.type === "o-o" || m.type === "o->"){return"url(#circle-start-arrow)"} else{return""}}}).attr("marker-end", function(m){if (m.type === "-->" || m.type === "<->" || m.type === "o->"){return"url(#end-arrow)"} else{if (m.type === "o-o"){return"url(#circle-end-arrow)"} else{return""}}}); var a = g.append("svg:g").selectAll("circle").data(c.nodes()).enter().append("svg:circle").attr("r", 6).call(c.drag); var i = g.append("svg:g").selectAll("text").data(c.nodes()).enter().append("svg:text").attr("x", 8).attr("y", ".31em").text(function(m){return m.name}); function f(){l.attr("d", h).each(function(){this.parentNode.insertBefore(this, this)}); a.attr("transform", e); i.attr("transform", e)}function h(p){var n = p.target.x - p.source.x, m = p.target.y - p.source.y, o = Math.sqrt(n * n + m * m); return"M" + p.source.x + "," + p.source.y + "A" + o + "," + o + " 0 0,1 " + p.target.x + "," + p.target.y}function e(m){return"translate(" + m.x + "," + m.y + ")"}};