
function plotGraph(c){var q={};var u=window.innerWidth-40;var e=window.innerHeight-40;var w=6;var r=0;var g={};var x=0.1;c.forEach(function(y){y.source=q[y.source]||(q[y.source]={name:y.source});y.target=q[y.target]||(q[y.target]={name:y.target})});var q=Object.keys(q).map(function(y){return q[y]});var b=d3.zoom().scaleExtent([0.2,10]).on("zoom",m);var n=d3.select("#causal-graph").append("svg").attr("width",u).attr("height",e).call(b).on("dblclick.zoom",null);var a=n.append("g");var h=d3.forceSimulation(q).force("link",d3.forceLink().id(function(y){return y.index})).force("charge",d3.forceManyBody()).force("collide",d3.forceCollide(2)).force("center",d3.forceCenter(u/2,e/2)).on("tick",f);h.force("link").links(c);h.force("link").distance(60);for(i=0;i<q.length;i++){g[i+","+i]=1}c.forEach(function(y){g[y.source.index+","+y.target.index]=1});a.append("defs").append("marker").attr("id","marker-start-arrow").attr("viewBox","0 -5 10 10").attr("refX",-10).attr("refY",0).attr("markerWidth",w).attr("markerHeight",w).attr("orient","auto").append("path").attr("d","M10,-5L0,0L10,5").attr("class","marker-start-arrow");a.append("defs").append("marker").attr("id","marker-start-circle").attr("viewBox","0 -5 10 10").attr("refX",-8).attr("refY",0).attr("markerWidth",w).attr("markerHeight",w).attr("orient","auto").append("circle").attr("cx",6).attr("cy",0).attr("r",4).attr("class","marker-start-circle");a.append("defs").append("marker").attr("id","marker-end-arrow").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",w).attr("markerHeight",w).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("class","marker-end-arrow");a.append("defs").append("marker").attr("id","marker-end-circle").attr("viewBox","0 -5 10 10").attr("refX",20).attr("refY",0).attr("markerWidth",w).attr("markerHeight",w).attr("orient","auto").append("circle").attr("cx",6).attr("cy",0).attr("r",4).attr("class","marker-end-circle");var j=a.append("g").selectAll(".link").data(c).enter().append("line").attr("class","link").attr("marker-start",function(y){if(y.type==="<->"){return"url(#marker-start-arrow)"}else{if(y.type==="o-o"||y.type==="o->"){return"url(#marker-start-circle)"}else{return""}}}).attr("marker-end",function(y){if(y.type==="-->"||y.type==="<->"||y.type==="o->"){return"url(#marker-end-arrow)"}else{if(y.type==="o-o"){return"url(#marker-end-circle)"}else{return""}}});var s=a.append("g").selectAll(".node").data(q).enter().append("circle").attr("class","node").attr("r",w).on("dblclick",t).call(d3.drag().on("start",o).on("drag",k).on("end",p));var l=a.append("g").selectAll(".node-name").data(q).enter().append("text").attr("class","node-name").attr("x",8).attr("y",".31em").text(function(y){return y.name});function f(){s.attr("cx",function(y){return y.x=Math.max(w,Math.min(u-w,y.x))}).attr("cy",function(y){return y.y=Math.max(w,Math.min(e-w,y.y))});j.attr("x1",function(y){return y.source.x}).attr("y1",function(y){return y.source.y}).attr("x2",function(y){return y.target.x}).attr("y2",function(y){return y.target.y});l.attr("x",function(y){return y.x+w}).attr("y",function(y){return y.y+w/2})}function m(){a.attr("transform",d3.event.transform)}function v(z,y){return g[z.index+","+y.index]}function t(){if(r===0){d=d3.select(this).node().__data__;s.style("opacity",function(y){return v(d,y)|v(y,d)?1:x});l.style("opacity",function(y){return v(d,y)|v(y,d)?1:x});j.style("opacity",function(y){return d.index===y.source.index|d.index===y.target.index?1:x});r=1}else{s.style("opacity",1);l.style("opacity",1);j.style("opacity",1);r=0}}function o(){if(!d3.event.active){h.alphaTarget(0.3).restart()}d3.event.subject.fx=d3.event.subject.x;d3.event.subject.fy=d3.event.subject.y}function k(){d3.event.subject.fx=d3.event.x;d3.event.subject.fy=d3.event.y}function p(){if(!d3.event.active){h.alphaTarget(0)}d3.event.subject.fx=null;d3.event.subject.fy=null}$("#searchBtn").click(function(){var B=$("#search").val();var A=a.selectAll(".node");if(B===""){A.style("stroke","white").style("stroke-width","1")}else{var y=A.filter(function(D,C){return D.name.toLowerCase()!==B.toLowerCase()});y.style("opacity","0");var z=a.selectAll(".link");z.style("opacity","0");d3.selectAll(".node, .link").transition().duration(5000).style("opacity",1)}})};